<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Daniel J. Harvey - Typeclasses - Show</title>
    <link rel="stylesheet" href="https://danieljharvey.github.io/main.css">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RKDYZB38Z0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-RKDYZB38Z0');
    </script>
</head>

<body>
    <header>
        <div class="logo">
            <a href="/">Daniel J. Harvey</a>
        </div>
        <nav>
            <a href="/">Posts</a>
        </nav>
    </header>

    <main role="main">
        
<h1 class="title">
  Typeclasses - Show
</h1>
<p class="subtitle"><strong>2018-11-11</strong></p>
<p>
 <p class="blog-meta">
        
        <a href="https:&#x2F;&#x2F;danieljharvey.github.io/tags/haskell/"
          >#haskell</a
        > 
        <a href="https:&#x2F;&#x2F;danieljharvey.github.io/tags/typeclasses/"
          >#typeclasses</a
        >
         
      </p>

<p>Let's think about things.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">data </span><span style="color:#d08770;">Thing </span><span>= </span><span style="color:#d08770;">Thing1 </span><span>| </span><span style="color:#d08770;">Thing2
</span></code></pre>
<p>Seems great so far. Let's try and look at one in <code>ghci</code>.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#d08770;">Prelude</span><span>&gt; show </span><span style="color:#d08770;">Thing1
</span></code></pre>
<p>Oh shit!</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span>• </span><span style="color:#d08770;">No </span><span style="color:#b48ead;">instance </span><span style="color:#bf616a;">for</span><span> (</span><span style="color:#b48ead;">Show Thing</span><span>) </span><span style="color:#bf616a;">arising from a use of</span><span> ‘</span><span style="color:#bf616a;">show</span><span>’
</span><span>• </span><span style="color:#d08770;">In</span><span> the expression: show </span><span style="color:#d08770;">Thing1
</span><span>    </span><span style="color:#d08770;">In</span><span> an equation for ‘it’: it = show </span><span style="color:#d08770;">Thing1
</span></code></pre>
<p>Totally bogus!</p>
<p>So what's the problem? So for something to be shown in the console, we need to know how to convert it into a String. This is a pretty common thing to be able to do, so we have a typeclass for it, called <code>Show</code>. Let's check it out in <code>ghci</code>.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#d08770;">Prelude</span><span>&gt; :i </span><span style="color:#d08770;">Show
</span></code></pre>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">Show </span><span style="color:#bf616a;">a </span><span style="color:#b48ead;">where
</span><span>  </span><span style="color:#8fa1b3;">showsPrec </span><span style="color:#b48ead;">:: Int -&gt; </span><span style="color:#bf616a;">a </span><span style="color:#b48ead;">-&gt; ShowS
</span><span>  </span><span style="color:#8fa1b3;">show </span><span style="color:#b48ead;">:: </span><span style="color:#bf616a;">a </span><span style="color:#b48ead;">-&gt; String
</span><span>  </span><span style="color:#8fa1b3;">showList </span><span style="color:#b48ead;">::</span><span> [</span><span style="color:#bf616a;">a</span><span>] </span><span style="color:#b48ead;">-&gt; ShowS
</span><span>  {-# </span><span style="color:#b48ead;">MINIMAL</span><span> showsPrec | show #-}
</span></code></pre>
<p>A few more things than expected, tbh. Fortunately, that <code>{-# MINIMAL showsPrec | show #-}</code> means we can just define <code>show</code>, which takes any value of a type and turns it into a <code>String</code>.</p>
<p>Let's make another data type.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">data </span><span style="color:#d08770;">BetterThing </span><span>= </span><span style="color:#d08770;">Better1 </span><span>| </span><span style="color:#d08770;">Better2
</span></code></pre>
<p>This time, we'll create an instance of <code>Show</code> for it.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">instance Show BetterThing where
</span><span>    show </span><span style="color:#d08770;">Better1 </span><span>= &quot;</span><span style="color:#a3be8c;">Better thing 1</span><span>&quot;
</span><span>    show </span><span style="color:#d08770;">Better2 </span><span>= &quot;</span><span style="color:#a3be8c;">The other even better thing</span><span>&quot;
</span></code></pre>
<p>Now we can <code>show</code> it as much as we like.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#8fa1b3;">showBetter1 </span><span style="color:#b48ead;">:: String
</span><span>showBetter1 = show </span><span style="color:#d08770;">Better1
</span><span style="color:#65737e;">-- showBetter1 = &quot;Better thing 1&quot;
</span></code></pre>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#8fa1b3;">showBetter2 </span><span style="color:#b48ead;">:: String
</span><span>showBetter2 = show </span><span style="color:#d08770;">Better2
</span><span style="color:#65737e;">-- showBetter2 = &quot;The other even better thing&quot;
</span></code></pre>
<p>Great! What if we don't need particularly clever string output? Just the name of the type would be fine. Can we cheat and derive one?</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">data </span><span style="color:#d08770;">LazyThing </span><span>= </span><span style="color:#d08770;">Lazy </span><span>| </span><span style="color:#d08770;">Crazy </span><span>| </span><span style="color:#d08770;">Other </span><span style="color:#b48ead;">deriving</span><span> (</span><span style="color:#a3be8c;">Show</span><span>)
</span></code></pre>
<p>Nothing seemed to complain there. Good stuff!</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#8fa1b3;">showLazy </span><span style="color:#b48ead;">:: String
</span><span>showLazy = show </span><span style="color:#d08770;">Lazy
</span><span style="color:#65737e;">-- showLazy == &quot;Lazy&quot;
</span></code></pre>
<p>Success! And, so, as one would expect...</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#8fa1b3;">showCrazy </span><span style="color:#b48ead;">:: String
</span><span>showCrazy = show </span><span style="color:#d08770;">Crazy
</span><span style="color:#65737e;">-- showCrazy == &quot;Crazy&quot;
</span></code></pre>
<p>That's better, but is there anything a bit more interesting we could do with this? Sure thing! What about a data type for creating HTML markup?</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">type </span><span style="color:#d08770;">Href </span><span>= </span><span style="color:#d08770;">String
</span><span>
</span><span style="color:#b48ead;">data </span><span style="color:#d08770;">HTMLTree </span><span>= </span><span style="color:#d08770;">Div</span><span> [</span><span style="color:#d08770;">HTMLTree</span><span> a]
</span><span>              | </span><span style="color:#d08770;">Title String
</span><span>              | </span><span style="color:#d08770;">P String
</span><span>              | </span><span style="color:#d08770;">A Href</span><span> [</span><span style="color:#d08770;">HTMLTree</span><span> a]
</span></code></pre>
<p>That <code>type</code> alias for <code>Href</code> just means it's a normal string, but it makes the intent a bit clearer. So this little markup type has four kinds of element.</p>
<ol>
<li><code>Div</code> has no content of it's own but is also a wrapper for a list of <code>HTMLTree a</code> elements.</li>
<li><code>Title</code> also takes a <code>String</code> and has no child elements.</li>
<li><code>P</code> takes a <code>String</code> and has no child elements.</li>
<li><code>A</code> takes an <code>Href</code> (an alias for <code>String</code>) and a list of children of type <code>HTMLTree a</code>.</li>
</ol>
<p>Let's put it to work making an internet website.</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#8fa1b3;">website </span><span style="color:#b48ead;">:: Tree String
</span><span>website = </span><span style="color:#d08770;">Div
</span><span>        [ </span><span style="color:#d08770;">Title </span><span>&quot;</span><span style="color:#a3be8c;">My interesting website</span><span>&quot;
</span><span>        , </span><span style="color:#d08770;">P </span><span>&quot;</span><span style="color:#a3be8c;">Item of interest</span><span>&quot;
</span><span>        , </span><span style="color:#d08770;">A </span><span>&quot;</span><span style="color:#a3be8c;">http://danieljharvey.github.io</span><span>&quot; [ </span><span style="color:#d08770;">P </span><span>&quot;</span><span style="color:#a3be8c;">Home</span><span>&quot; ]
</span><span>        , </span><span style="color:#d08770;">Div</span><span> [ </span><span style="color:#d08770;">P </span><span>&quot;</span><span style="color:#a3be8c;">Sub-item</span><span>&quot;
</span><span>              , </span><span style="color:#d08770;">P </span><span>&quot;</span><span style="color:#a3be8c;">Another sub-item</span><span>&quot;
</span><span>              ]
</span><span>        ]
</span></code></pre>
<p>Looks like the beginnings of a world beating internet business to me. How can <code>Show</code> help us though?</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#b48ead;">instance</span><span> (</span><span style="color:#b48ead;">Show </span><span style="color:#bf616a;">a</span><span>) </span><span style="color:#b48ead;">=&gt; Show</span><span> (</span><span style="color:#b48ead;">Tree </span><span style="color:#bf616a;">a</span><span>) </span><span style="color:#b48ead;">where
</span><span>    show (</span><span style="color:#d08770;">Div</span><span> as) = &quot;</span><span style="color:#a3be8c;">&lt;div&gt;</span><span>&quot; ++ concatSubtags as ++ &quot;</span><span style="color:#a3be8c;">&lt;/div&gt;</span><span>&quot;
</span><span>    show (</span><span style="color:#d08770;">A</span><span> href as) = &quot;</span><span style="color:#a3be8c;">&lt;a href=&#39;</span><span>&quot; ++ href ++ &quot;</span><span style="color:#a3be8c;">&#39;&gt;</span><span>&quot;
</span><span>                     ++ concatSubtags as ++ &quot;</span><span style="color:#a3be8c;">&lt;/a&gt;</span><span>&quot;
</span><span>    show (</span><span style="color:#d08770;">P</span><span> a) = &quot;</span><span style="color:#a3be8c;">&lt;p&gt;</span><span>&quot; ++ a ++ &quot;</span><span style="color:#a3be8c;">&lt;/p&gt;</span><span>&quot;
</span><span>    show (</span><span style="color:#d08770;">Title</span><span> a) = &quot;</span><span style="color:#a3be8c;">&lt;h1&gt;</span><span>&quot; ++ a ++ &quot;</span><span style="color:#a3be8c;">&lt;/h1&gt;</span><span>&quot;
</span><span>
</span><span style="color:#65737e;">-- utility function for showing child items
</span><span style="color:#8fa1b3;">concatSubtags </span><span style="color:#b48ead;">::</span><span> (</span><span style="color:#b48ead;">Show </span><span style="color:#bf616a;">a</span><span>) </span><span style="color:#b48ead;">=&gt;</span><span> [</span><span style="color:#b48ead;">Tree </span><span style="color:#bf616a;">a</span><span>] </span><span style="color:#b48ead;">-&gt; String
</span><span>concatSubtags as = concat $ fmap show as
</span></code></pre>
<p>By defining a <code>show</code> function for each of our tags (and recursively calling <code>show</code> for tags with child elements) we can generate HTML markup using one easy function:</p>
<pre data-lang="haskell" style="background-color:#2b303b;color:#c0c5ce;" class="language-haskell "><code class="language-haskell" data-lang="haskell"><span style="color:#d08770;">Prelude</span><span>&gt; show website
</span></code></pre>
<p>Hooray! A website!</p>
<pre data-lang="html" style="background-color:#2b303b;color:#c0c5ce;" class="language-html "><code class="language-html" data-lang="html"><span>&lt;</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">h1</span><span>&gt;My interesting website&lt;/</span><span style="color:#bf616a;">h1</span><span>&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">p</span><span>&gt;Item of interest&lt;/</span><span style="color:#bf616a;">p</span><span>&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">a </span><span style="color:#d08770;">href</span><span>=&quot;</span><span style="color:#a3be8c;">http://danieljharvey.github.io</span><span>&quot;&gt; &lt;</span><span style="color:#bf616a;">p</span><span>&gt;Website&lt;/</span><span style="color:#bf616a;">p</span><span>&gt; &lt;/</span><span style="color:#bf616a;">a</span><span>&gt;
</span><span>  &lt;</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">p</span><span>&gt;Sub-item&lt;/</span><span style="color:#bf616a;">p</span><span>&gt;
</span><span>    &lt;</span><span style="color:#bf616a;">p</span><span>&gt;Another sub-item&lt;/</span><span style="color:#bf616a;">p</span><span>&gt;
</span><span>  &lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span><span>&lt;/</span><span style="color:#bf616a;">div</span><span>&gt;
</span></code></pre>
<p>(Actually it comes out in one big line, and then I added the line breaks to fit it on the page. Oh, the lies!)</p>
<p>It could do with a bit of sprucing up, and a few more tags, but in my by no means humble opinion we're on our way to creating the next React-beater. Great job, <code>show</code>.</p>
<p>(Incidentally, although this is a more fun example of <code>show</code>, I'd probably recommend just using a normal function for this kind of thing. Something classic like <code>renderTree :: (Show a) =&gt; Tree a -&gt; String</code> maybe. This isn't strictly what the <code>Show</code> typeclass is for. There is also another type class called <code>Read</code> whose job is to turn the <code>String</code> output of <code>show</code> back into the original data type, and so making a clever <code>show</code> instance you're somewhat implicitly promising that you can turn it back somehow. This could end up being a Bad Time, and that's exactly the kind of time we don't want to have.)</p>
<p>Make sense? If not, why not <a href="/contact.html">get in touch</a>?</p>
<p>Further reading:</p>
<p><a href="http://hackage.haskell.org/package/base-4.12.0.0/docs/Text-Show.html">Text.Show</a></p>


    </main>

    <footer>
      <p><a href="mailto:danieljamesharvey@gmail.com">Contact</a> |
      <a href="https://github.com/danieljharvey">Github</a></p>
      <p>Links for nerds:
        <a href="/atom.xml">atom</a>
        <a href="/rss.xml">rss</a></p>

    </footer>
</body>

</html>
